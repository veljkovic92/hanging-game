const input = document.querySelector(".input")
const input2 = document.querySelector(".input2")
const btn = document.querySelector(".btn")
const btn2 = document.querySelector(".btn2")
const letters = document.querySelector(".letters")
let lives = document.querySelector(".lives")
let spanEl = document.getElementsByTagName("span")
const img = document.querySelector(".img")
const win = document.querySelector(".win")
const resBtn = document.querySelector(".restartBtn")
const livesLeft = document.querySelector(".livesLeft")
let startGame = true;

let wordArray = []
let lettersArray = []
let newElArray = []
let newEl2Array = []
let livesNo = ''
let imgMistake = 6
let lastArray = []
let word = ''
let wordChar = ''
let newEl = ''
let newEl2 = ''
let newNew = ''
let newNew2 = ''
let lettersPop = ''
btn.textContent = "START"

btn.addEventListener("click", function() {


  if (startGame === true) {
    word = input.value
    img.setAttribute("src", "images/pic.jpg")
    btn.textContent = "Try"
    wordChar = word.split("")
    livesLeft.textContent = "LIVES LEFT:"
    lives.textContent = word.length
    livesNo = word.length
    startGame = false
    btn.classList.add("btn2")
    btn.classList.remove("btn")


    createLetters(word, wordChar)
    tryyy(word, wordArray, lettersArray)

    function createLetters(word, wordChar) {

      for (let i = 0; i < word.length; i++) {

        wordArray.push(wordChar[i])
        newEl = document.createElement("span")
        newEl.textContent = "?"
        letters.appendChild(newEl)
        newEl.classList.add("newElClass")
        newEl2 = document.createElement("span")
        newEl2.textContent = wordChar[i]
        letters.appendChild(newEl2)
        newEl2.classList.add("hidden", "newEl2Class")
        newEl2Array.push(newEl2.innerText)

      }

    }
  }

})



function tryyy(word, wordArray, lettersArray) {

  btn2.addEventListener("click", function() {
    if (startGame === false) {

      if (input.value.length !== 1) {
        alert("Please add one character")
      } else {
        newNew = document.querySelectorAll(".newEl2Class")
        newNew2 = document.querySelectorAll(".newElClass")
        for (let i = 0; i < wordArray.length; i++) {


          if (newNew[i].textContent == input.value) {
            newNew[i].classList.remove("hidden")
            newNew2[i].classList.add("hidden")
          }
        }
        lettersArray.push(input.value)
        lettersPop = lettersArray.pop()


        if (wordArray.includes(lettersPop)) {

          lastArray.push(lettersPop)

          if (newEl2Array.length === lastArray.length && JSON.stringify(newEl2Array) == JSON.stringify(lastArray)) {
            win.textContent = "ODI DEDI NA KOPAN"
          }
        } else if (lives.innerText > 1) {
          console.log(lives);
          lives.innerText--
          img.setAttribute("src", `images/pic${imgMistake}.jpg`)
          imgMistake--
        } else {
          console.log(lives);
          lives.innerText--
          win.innerText = "You lost, baybe!"
          resBtn.removeAttribute("class", "restartBtn")

        }
      }
    }
  })

  console.log(lives);
}


function gameRestart() {
  startGame = true;
  wordArray = []
  lettersArray = []
  newElArray = []
  newEl2Array = []
  livesNo = ''
  imgMistake = 6
  lastArray = []
  letters.innerHTML = "";
  img.setAttribute("src", "")
  btn.textContent = "START"
  btn.classList.add("btn")
  btn.classList.remove("btn2")
  word = ''
  wordChar = ''
  newEl = ''
  newEl2 = ''
  newNew = ''
  newNew2 = ''
  lettersPop = ''
  win.textContent = ''
  resBtn.setAttribute("class", "restartBtn")
  livesLeft.innerHTML = ''
  lives.innerHTML = ''
  input.value = ''
  console.log(btn.classList);
}
